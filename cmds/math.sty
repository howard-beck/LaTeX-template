\makeatletter

%% NOTATIONS
\def\tof#1{\xrightarrow{#1}}
\let\incl\hookrightarrow
\let\incled\hookleftarrow
\def\inclUP{\mathrel{\rotatebox[origin=c]{90}{$\incl$}}}

% https://tex.stackexchange.com/questions/2607/spacing-around-left-and-right
\let\@old@left\left
\let\@old@right\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\@old@left}
\renewcommand{\right}{\aftergroup\egroup\@old@right}

\let\emptyset\varnothing

%% COMPLEX NUMBERS
% https://tex.stackexchange.com/questions/668241/lowercase-mathscr-and-mathcal-letters
\def\Re{\mathscr{R\hspace{-0.1em}e}}
\def\Im{\mathscr{I\hspace{-0.1em}m}}
\let\conj\overline

%% CATEGORIES
\let\@style@cat\mathsf
\let\@style@funct\mathrm
\let\@style@op\mathrm
\let\@style@cat@desc\mathrm

\NewDocumentCommand\makecat{m O{#1}}{\expandafter\def\csname#1\endcsname{\@style@cat{#2}\xspace}}
\NewDocumentCommand\makeop{m O{#1}}{\expandafter\def\csname#1\endcsname{\@style@op{#2}\xspace}}
\NewDocumentCommand\makefunct{m O{#1}}{\expandafter\def\csname#1\endcsname{\@style@funct{#2}\xspace}}
\def\makecatdesc#1{\expandafter\def\csname#1\endcsname{\@style@cat@desc{#1}\xspace}}

\def\makecat@pt#1{\expandafter\def\csname#1\endcsname{%
    \@style@cat{#1}%
    \@ifnextchar*{_{\pt}\expandafter\@gobble}{}%
}}
\NewDocumentCommand\makefunct@pt{m O{#1}}{\expandafter\def\csname#1\endcsname{%
    \@style@funct{#2}%
    \@ifnextchar*{_{\pt}\expandafter\@gobble}{}%
}}

% adjoint pair
\let\adjoint\rightleftharpoons

% isomorphism
\let\iso\simeq
\def\toiso{\tof{\sim}}
% from arrow
\let\from\leftarrow

% opposite category
\makecatdesc{op}

% small categories
\makecat{Cat}
% locally small categories
\makecat{CAT}

\makecat{Set}
\makecat{Poset}
\makecat{FinSet}

% Hom bifunctor
\makefunct{Hom}
% functor category
\makecat{Fun}
% presheaf category
\makecat{Psh}

% finite
\makecatdesc{fin}
% virtual
\makecatdesc{virt}

% realization: Grpd --> Cat
\makefunct{B}

% Higher Algebra ish
%  Dold-Kan correspondance
\makeop{DK}
% Cobar construction
\makeop{CB}
% Totalization
\makeop{Tot}

\def\arrowsep{3.5pt}
\newcommand\tto[1][2]{%
    \hspace{2pt}%
    \tikz{
        \foreach \n in {1,...,#1}{%
            \draw[->, transform canvas={shift={(0pt,\dimexpr2.5pt + \arrowsep*\n - \arrowsep/2 - \arrowsep/2*#1 \relax)}}] (0,0em) -- (1em,0em);
        }
    }%
    \hspace{2pt}%
}
\def\ttto{\tto[3]}
\newcommand\tfto[1][3]{%
    \hspace{2pt}%
    \tikz{
        \foreach \n in {1,...,#1}{%
            \ifodd\n
                \def\thisarrow{->}
            \else
                \def\thisarrow{<-}
            \fi
            \draw[\thisarrow, transform canvas={shift={(0pt,\dimexpr2.5pt + \arrowsep*\n - \arrowsep/2 - \arrowsep/2*#1 \relax)}}] (0,0em) -- (1em,0em);
        }
    }%
    \hspace{2pt}%
}
\newcommand\ftfrom[1][3]{%
    \hspace{2pt}%
    \tikz{
        \foreach \n in {1,...,#1}{%
            \ifodd\n
                \def\thisarrow{<-}
            \else
                \def\thisarrow{->}
            \fi
            \draw[\thisarrow, transform canvas={shift={(0pt,\dimexpr2.5pt + \arrowsep*\n - \arrowsep/2 - \arrowsep/2*#1 \relax)}}] (0,0em) -- (1em,0em);
        }
    }%
    \hspace{2pt}%
}



%% ALGEBRA
% Rings
\def\R{\mathbb{R}}
\def\C{\mathbb{C}}
\def\Z{\mathbb{Z}}
\def\Q{\mathbb{Q}}
\def\F{\mathbb{F}}
% quaternions
\def\QH{\mathbb{H}}

% Linear algebra
\def\GL{\mathrm{GL}}
\def\O{\mathrm{O}}
\def\U{\mathrm{U}}
\def\SL{\mathrm{SL}}
\def\SO{\mathrm{SO}}
\def\SU{\mathrm{SU}}
\def\GL{\mathrm{GL}}
\def\O{\mathrm{O}}
\def\U{\mathrm{U}}
\def\PGL{\mathrm{PGL}}
\def\PO{\mathrm{PO}}
\def\PSU{\mathrm{PSU}}
\def\PSL{\mathrm{PSL}}

% Some categories
% groups
\makecat{Grp}
% groupoids
\makecat{Grpd}
% abelian groups
\makecat{Ab}
% arbitrary ring
\makecat{Ring}
% commutative rings
\makecat{CRing}
% graded
\makecat{Gr}
\def\GrRing{\Gr\Ring}
% fields
\makecat{Field}
% modules
\makecat{Mod}
% comodules
\makecat{Comod}
% vector spaces
\makecat{Vect}
% commutative algebra objects
\makecat{CAlg}
% Ext
\makefunct{Ext}

% automorphisms
\makeop{Aut}

% operations
% direct sum
\let\dsum\oplus
% (virtual) direct difference
\let\dminus\ominus
\let\ddiff\dminus
% direct product
\let\dprod\otimes

% https://tex.stackexchange.com/questions/24185/redefine-underscore-on-a-per-command-basis
\def\tprod{%
    \@ifnextchar_{\tprod@}{\otimes}
}
\def\tprod@_#1{
    \underset{#1}{\otimes}
}


\let\@old@times\times
\def\times{%
    \@ifnextchar_{\times@}{\@old@times}
}
\def\times@_#1{
    \underset{#1}{\@old@times}
}


% cokernel
\def\coker{\mathrm{coker}}

%% ALGEBRAIC GEOMETRY
\makefunct{Aut}
\def\Mfg{\mathcal{M}_{\mathrm{fg}}}
\def\G{\mathbb{G}}
\def\Ghat{\widehat{\mathbb{G}}}

\def\Gm{\G_m}

\makefunct{Spec}



%% EQUIVARIANT
% orbit category
\def\Orb#1{\mathcal{O}_{#1}}
% family of subgroups
\def\family{\mathcal{F}}
\def\cofamily{\mathcal{N}}

% rank
\def\rk{\mathrm{rk}}
% corank
\def\cork{\mathrm{cork}}
\makecat{Nm}

% real representation ring
\makecat{RO}



%% TOPOLOGY
\makecat@pt{Top}

% homeomorphisms
\let\homeo\cong
\let\homeom\homeo

% point
\def\pt{*}

% suspension functor
\let\Susp\Sigma
% loop functor
\let\Loop\Omega


% (homotopy)(co)fibers
\def\fib{\mathrm{fib}}
\def\hofib{\mathrm{hofib}}
\def\cofib{\mathrm{cofib}}
\def\hocofib{\mathrm{hocofib}}

\def\h{\mathsf{h}}

% Mapping spaces
\makefunct@pt{Map}

% cup product
\let\@old@cup\cup
\let\cup\smile
\def\union{%
    \@ifnextchar_{\union@}{\@old@cup}
}
\def\union@_#1{
    \underset{#1}{\@old@cup}
}

% wedge sums use the \vee symbol, and smash products use the \wedge symbol
% exchange these
% \smash is used in subsections somehow, so we'll keep it around
\let\@old@wedge\wedge
\let\@old@bidwedge\bigwedge
\let\wedge\vee
% smash product
\let\Smash\otimes
\let\@old@smash\smash
\def\smash{%
    \relax\ifmmode%
        \Smash%
    \else%
        \expandafter\@old@smash%
    \fi%
}


\let\SpSmash\@old@wedge
\let\SmashSp\SpSmash

\let\bigsmashsp\@old@bigwedge
\let\bigsmash\bigotimes
\let\bigwedge\bigvee

% Algebraic topology
% (co)homology
\def\H{\mathrm{H}}
% Steenrod squares
\def\Sq{\mathrm{Sq}}
% Steenrod algebra
\def\Steenrod#1{\mathcal{A}_{#1}}
\def\Ap{\Steenrod{p}}

% Differential topology
\def\T{\mathrm{T}}



%% Stable
\makecat{Sp}
\def\Spfin{\Sp^\omega}
\def\Sppfin{\Spfin_{(p)}}

\def\Suspinf{%
    \Susp^{\infty}%
    \@ifnextchar+{%
        _{+}%
        \@gobble
    }{}%
}
\def\Loopinf{\Loop^{\infty}}

% completion
\newcommand\compl[1][]{%
    \ifthenelse{\equal{#1}{}}%
    {%
        ^{\@old@wedge}%
    }{%
        _{#1}^{\@old@wedge}%
    }%
}
\def\pcompl{\compl[p]}

\NewDocumentCommand\makespectrum{m O{#1}}{%
    \expandafter\def\csname#1\endcsname{\mathcal@sp{#2}}%
}
\def\S{\mathbb{S}}
\makespectrum{MU}
\makespectrum{BP}
\makespectrum{tmf}
% Morava K-theory
\makespectrum{K}
% telescope
\makespectrum{T}
\makespectrum{KU}
\makespectrum{KO}
\makespectrum{LT}[E]
\def\En{\LT_{n}}

% Eilenberg-MacLane spectrum
\makespectrum{EM}[H]
% Z-valued E-M spectrum
\def\HZ{\EM\Z}

% algebraic K-theory and friends
\makeop{Kalg}[K]
\makeop{THH}
\makeop{TC}
\makeop{TR}

% E_n spectra
\def\E#1{\mathbb{E}_{#1}}
% E_\infty spectra
\def\Einf{\E{\infty}}
% H_\infty spectrum
\def\Hinf{{\normalfont \textit{H}}_{\infty}}

%% chromatic
\def\height{\mathrm{height}}

%% equivariant
\def\tate{\mathrm{t}}
\def\tCp{\tate C_p}
\def\tG{\tate G}
\let\GeomFix\Phi

\def\borel#1{\underline{#1}}



\makeatother